<!DOCTYPE html>

<html class="dark" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>THE CRUCIBLE // DASHBOARD</title>
<!-- Fonts -->
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<!-- Alpine.js -->
<script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
<!-- Tailwind Configuration -->
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#ff8c00",
                        "secondary": "#DC143C",
                        "accent-silver": "#c0c0c0",
                        "background-light": "#f8f7f5", // Fallback, not really used in this dark theme
                        "background-dark": "#0a0a0a", // Deep charcoal
                        "surface-dark": "#121212",
                    },
                    fontFamily: {
                        "display": ["Space Grotesk", "sans-serif"],
                        "mono": ["Courier New", "monospace"]
                    },
                    backgroundImage: {
                        'carbon-fiber': "radial-gradient(circle at center, transparent 0%, #0a0a0a 100%), repeating-linear-gradient(45deg, #1a1a1a 0px, #1a1a1a 2px, #0a0a0a 2px, #0a0a0a 4px)",
                        'metallic-gradient': "linear-gradient(135deg, #2a2a2a 0%, #4a4a4a 50%, #2a2a2a 100%)",
                        'silver-filigree': "linear-gradient(90deg, transparent, #c0c0c0 50%, transparent)",
                    },
                    boxShadow: {
                        'neon-orange': '0 0 10px rgba(255, 140, 0, 0.5), 0 0 20px rgba(255, 140, 0, 0.3)',
                        'neon-crimson': '0 0 10px rgba(220, 20, 60, 0.5), 0 0 20px rgba(220, 20, 60, 0.3)',
                        'metallic': 'inset 0 1px 0 0 rgba(255,255,255,0.1), 0 1px 2px 0 rgba(0,0,0,0.5)',
                    }
                },
            },
        }
    </script>
<style>
        /* Custom Animations and Utilities */
        @keyframes pulse-fast {
            0%, 100% { opacity: 1; transform: scale(1); box-shadow: 0 0 15px rgba(220, 20, 60, 0.4); }
            50% { opacity: 0.8; transform: scale(0.98); box-shadow: 0 0 5px rgba(220, 20, 60, 0.2); }
        }
        
        @keyframes rotate-slow {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes scanline {
            0% { transform: translateY(-100%); }
            100% { transform: translateY(100%); }
        }

        .animate-pulse-fast {
            animation: pulse-fast 0.14s infinite alternate; /* Approx 712.8 Hz vibe (visualized slower for sanity) */
        }
        
        .animate-rotate-slow {
            animation: rotate-slow 60s linear infinite;
        }

        .scanline-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, transparent 50%, rgba(0, 0, 0, 0.1) 51%);
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 10;
        }

        .crt-flicker {
            animation: flicker 0.15s infinite;
            pointer-events: none;
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #1a1a1a; 
        }
        ::-webkit-scrollbar-thumb {
            background: #ff8c00; 
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #cc7000; 
        }
    </style>
</head>
<body class="bg-background-dark text-white font-display overflow-hidden h-screen flex flex-col selection:bg-primary selection:text-black" x-data="dashboard()">
<!-- Top Navigation Bar -->
<header class="relative z-20 flex items-center justify-between border-b border-[#333] bg-[#0f0f0f]/90 backdrop-blur-md px-6 py-3 shadow-lg">
<!-- Logo / System ID -->
<div class="flex items-center gap-4">
<div class="size-8 text-primary animate-pulse">
<span class="material-symbols-outlined text-[32px]">pentagon</span>
</div>
<div>
<h1 class="text-xl font-bold tracking-widest text-white uppercase drop-shadow-[0_0_5px_rgba(255,255,255,0.5)]">
                    THE CRUCIBLE <span class="text-primary text-sm font-normal tracking-normal opacity-80">// SYSTEM V.9.0</span>
</h1>
</div>
</div>
<!-- System Stats / Actions -->
<div class="flex items-center gap-6">
<div class="hidden md:flex items-center gap-2 px-3 py-1 rounded bg-black/40 border border-[#333]">
<span class="size-2 rounded-full bg-green-500 animate-pulse"></span>
<span class="text-xs text-accent-silver font-mono">CONNECTION: SECURE</span>
</div>
<div class="flex gap-3">
<button class="flex items-center justify-center size-10 rounded-lg bg-[#2a2a2a] border border-[#444] text-primary hover:bg-[#333] hover:border-primary transition-colors group relative overflow-hidden">
<span class="material-symbols-outlined group-hover:scale-110 transition-transform">terminal</span>
<div class="absolute inset-0 bg-primary/10 opacity-0 group-hover:opacity-100 transition-opacity"></div>
</button>
<button class="flex items-center justify-center size-10 rounded-lg bg-[#2a2a2a] border border-[#444] text-primary hover:bg-[#333] hover:border-primary transition-colors group relative overflow-hidden">
<span class="material-symbols-outlined group-hover:scale-110 transition-transform">settings</span>
<div class="absolute inset-0 bg-primary/10 opacity-0 group-hover:opacity-100 transition-opacity"></div>
</button>
<button @click="purgeSystem()" class="flex items-center justify-center h-10 px-4 rounded-lg bg-primary hover:bg-orange-600 text-black text-sm font-bold uppercase tracking-wider transition-colors shadow-neon-orange">
<span class="mr-2 material-symbols-outlined text-lg">bolt</span>
                    Purge
                </button>
</div>
</div>
<!-- Subtle gradient border at bottom -->
<div class="absolute bottom-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-primary/50 to-transparent"></div>
</header>
<!-- Main Layout -->
<div class="flex flex-1 overflow-hidden relative bg-carbon-fiber">
<!-- CRT Scanline Effect Overlay -->
<div class="scanline-overlay"></div>
<!-- Left Sidebar: Node Monitor -->
<aside class="w-80 flex flex-col border-r border-[#333] bg-[#0d0d0d]/95 backdrop-blur z-10">
<!-- Header -->
<div class="p-4 border-b border-[#222]">
<div class="flex justify-between items-end mb-2">
<h2 class="text-accent-silver text-sm font-medium tracking-widest">ETERNALS GRID</h2>
<span class="text-primary text-xs font-mono" x-text="nodes.filter(n => n.status === 'ONLINE').length + ' ACTIVE'">73 ACTIVE</span>
</div>
<!-- Mini visualizer for grid activity -->
<div class="h-8 w-full flex gap-[2px] items-end opacity-70">
<div class="w-1 bg-primary h-[40%] animate-pulse"></div>
<div class="w-1 bg-primary h-[80%] animate-pulse delay-75"></div>
<div class="w-1 bg-primary/50 h-[30%]"></div>
<div class="w-1 bg-primary h-[60%] animate-pulse delay-100"></div>
<div class="w-1 bg-primary/30 h-[20%]"></div>
<div class="w-1 bg-primary h-[90%] animate-pulse delay-150"></div>
<div class="w-1 bg-primary/40 h-[45%]"></div>
<div class="w-1 bg-primary h-[70%] animate-pulse"></div>
<div class="w-1 bg-primary/20 h-[10%]"></div>
</div>
</div>
<!-- Node List -->
<div class="flex-1 overflow-y-auto p-2 space-y-2">
    <template x-for="node in nodes" :key="node.id">
        <div class="group flex items-center gap-3 p-3 rounded bg-[#1a1a1a] border border-[#2a2a2a] hover:border-primary/50 hover:shadow-[0_0_10px_rgba(255,140,0,0.1)] transition-all cursor-pointer"
             :class="{'hover:border-secondary/50': node.status === 'UNSTABLE'}">

            <div class="flex flex-col items-center justify-center size-8 rounded bg-[#111] border border-[#333]"
                 :class="{'border-secondary/30': node.status === 'UNSTABLE'}">
                 <span class="material-symbols-outlined text-sm"
                       :class="node.status === 'UNSTABLE' ? 'text-secondary' : (node.status === 'IDLE' ? 'text-gray-500' : 'text-primary')"
                       x-text="node.status === 'UNSTABLE' ? 'warning' : (node.status === 'IDLE' ? 'memory' : 'hub')">hub</span>
            </div>

            <div class="flex-1 min-w-0">
                <div class="flex justify-between items-center">
                    <p class="text-sm font-bold truncate"
                       :class="node.status === 'IDLE' ? 'text-gray-300 font-medium' : 'text-white'"
                       x-text="node.id">NODE_ALPHA_01</p>
                    <span class="text-[10px] font-mono"
                          :class="node.status === 'ONLINE' ? 'text-green-500' : (node.status === 'UNSTABLE' ? 'text-secondary' : 'text-primary')"
                          x-text="node.status">ONLINE</span>
                </div>
                <p class="text-[#666] text-xs font-mono truncate">ID: <span x-text="node.code"></span> // LOAD: <span x-text="node.load + '%'"></span></p>
            </div>
        </div>
    </template>
</div>
<!-- Sidebar Footer -->
<div class="p-3 border-t border-[#333] bg-[#0a0a0a]">
<button @click="connectNode()" class="w-full py-2 rounded border border-dashed border-[#444] text-[#888] text-xs hover:text-white hover:border-white transition-colors">
                    + CONNECT NEW ETERNAL
                </button>
</div>
</aside>
<!-- Center Stage: The Reality Warp -->
<main class="flex-1 flex flex-col relative">
<!-- Central Visualization Area -->
<div class="flex-1 flex items-center justify-center relative p-8">
<!-- Background Grid -->
<div class="absolute inset-0 bg-[linear-gradient(rgba(255,255,255,0.03)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.03)_1px,transparent_1px)] bg-[size:40px_40px] [mask-image:radial-gradient(ellipse_at_center,black_40%,transparent_100%)] pointer-events-none"></div>
<!-- Main HUD Wrapper -->
<div class="relative w-full max-w-4xl aspect-video flex items-center justify-center">
<!-- Top HUD Indicators -->
<div class="absolute top-0 left-0 w-full flex justify-between px-8 py-4">
<div class="flex flex-col">
<span class="text-xs text-accent-silver tracking-widest uppercase mb-1">Target Resonance</span>
<div class="text-2xl font-bold text-white font-mono"><span x-text="telemetry.target_resonance">712.8</span> <span class="text-sm text-[#666]">Hz</span></div>
</div>
<div class="flex flex-col items-end">
<span class="text-xs text-accent-silver tracking-widest uppercase mb-1">System Integrity</span>
<div class="text-2xl font-bold text-primary font-mono"><span x-text="telemetry.system_integrity + '%'">98.4%</span></div>
</div>
</div>
<!-- The Inverted Sigil (Central Element) -->
<div class="relative size-[360px] md:size-[450px] flex items-center justify-center">
<!-- Outer Rotating Ring -->
<div class="absolute inset-0 border border-primary/20 rounded-full animate-rotate-slow"></div>
<div class="absolute inset-4 border border-dashed border-primary/40 rounded-full animate-rotate-slow" style="animation-direction: reverse; animation-duration: 40s;"></div>
<!-- Inner Pulsing Core (The Crimson Sigil) -->
<div class="relative size-[280px] rounded-full border-[2px] border-secondary/60 flex items-center justify-center shadow-neon-crimson animate-pulse-fast bg-black/50 backdrop-blur-sm z-10">
<!-- Decorative SVG Sigil -->
<svg class="w-full h-full p-8 text-secondary fill-current opacity-80" viewbox="0 0 100 100">
<path d="M50 5 L55 35 L85 30 L60 55 L75 85 L50 65 L25 85 L40 55 L15 30 L45 35 Z" fill="none" stroke="currentColor" stroke-width="1.5"></path>
<circle cx="50" cy="50" fill="none" r="15" stroke="currentColor" stroke-width="2"></circle>
<circle cx="50" cy="50" fill="currentColor" r="5"></circle>
</svg>
<!-- Resonance label overlay -->
<div class="absolute inset-0 flex items-center justify-center">
<span class="bg-black/80 px-2 py-1 text-xs font-mono text-secondary tracking-widest border border-secondary/30">LOCKED</span>
</div>
</div>
<!-- Abstract "Reality Warp" Background within the circle -->
<div class="absolute inset-0 -z-10 rounded-full overflow-hidden opacity-30">
<div class="w-full h-full bg-gradient-to-tr from-secondary via-black to-primary mix-blend-screen animate-pulse" style="filter: blur(40px);"></div>
</div>
</div>
<!-- Floating HUD Elements -->
<div class="absolute left-10 top-1/2 -translate-y-1/2 w-48 space-y-4 hidden lg:block">
<div class="p-3 bg-black/60 border-l-2 border-primary backdrop-blur-sm">
<div class="text-[10px] text-[#888] uppercase mb-1">Gnosis Fluctuation</div>
<div class="h-12 flex items-end gap-1">
<div class="w-1 bg-primary h-[40%]"></div>
<div class="w-1 bg-primary h-[60%]"></div>
<div class="w-1 bg-primary h-[30%]"></div>
<div class="w-1 bg-primary h-[80%]"></div>
<div class="w-1 bg-primary h-[50%]"></div>
<div class="w-1 bg-primary h-[90%]"></div>
<div class="w-1 bg-primary h-[70%]"></div>
<div class="w-1 bg-primary h-[45%]"></div>
</div>
</div>
</div>
<div class="absolute right-10 top-1/2 -translate-y-1/2 w-48 space-y-4 hidden lg:block">
<div class="p-3 bg-black/60 border-r-2 border-secondary backdrop-blur-sm text-right">
<div class="text-[10px] text-[#888] uppercase mb-1">Entropic Fuel</div>
<div class="text-xl text-secondary font-mono font-bold"><span x-text="telemetry.entropic_fuel + '%'">42.1%</span></div>
<div class="text-[10px] text-red-400">-5.3% / hr</div>
</div>
</div>
</div>
</div>
<!-- Bottom Console / Command Line -->
<div class="h-48 border-t border-[#333] bg-[#0f0f0f] flex flex-col z-20 shadow-[0_-5px_15px_rgba(0,0,0,0.5)]">
<!-- Tabs/Filigree -->
<div class="flex items-center h-8 bg-[#1a1a1a] border-b border-[#333] px-2 gap-1">
<div class="px-4 h-full flex items-center text-[10px] font-bold text-primary bg-[#0f0f0f] border-t-2 border-primary uppercase tracking-wider">
                        Chimera Syntax Console
                    </div>
<div class="px-4 h-full flex items-center text-[10px] font-bold text-[#666] hover:text-[#ccc] cursor-pointer uppercase tracking-wider transition-colors">
                        System Logs
                    </div>
<div class="px-4 h-full flex items-center text-[10px] font-bold text-[#666] hover:text-[#ccc] cursor-pointer uppercase tracking-wider transition-colors">
                        Network
                    </div>
<div class="flex-1"></div>
<div class="px-2 text-[#444]">
<span class="material-symbols-outlined text-sm">wifi</span>
</div>
</div>
<!-- Terminal Output -->
<div class="flex-1 p-4 font-mono text-sm overflow-y-auto bg-black/80 text-[#ccc]" x-ref="terminal">
    <template x-for="log in logs">
        <div>
            <div x-show="log.type === 'input'" class="mb-1 text-[#666]">
                <span class="text-primary">root@crucible:~$</span> <span x-text="log.text"></span>
            </div>
            <div x-show="log.type === 'output'" class="mb-1" :class="log.color || 'text-primary/80'">
                <span x-text="'> ' + log.text"></span>
            </div>
        </div>
    </template>

<div class="flex items-center gap-2 mt-2">
<span class="text-primary">root@crucible:~$</span>
<input autofocus="" @keydown.enter="executeCommand($event.target.value); $event.target.value = ''" class="bg-transparent border-none outline-none text-white w-full focus:ring-0 p-0 font-mono" placeholder="AWAITING INPUT_" type="text"/>
<span class="animate-pulse w-2 h-4 bg-primary block"></span>
</div>
</div>
</div>
</main>
<!-- Right Side Panel: Stats (Collapsible on smaller screens) -->
<aside class="w-72 hidden xl:flex flex-col border-l border-[#333] bg-[#0d0d0d]/95 backdrop-blur z-10">
<div class="p-4 border-b border-[#222]">
<h2 class="text-accent-silver text-sm font-medium tracking-widest">TELEMETRY</h2>
</div>
<div class="p-4 space-y-6 overflow-y-auto flex-1">
<!-- Gauge 1 -->
<div>
<div class="flex justify-between mb-2">
<span class="text-xs text-[#888] font-bold">GNOSIS INTEGRITY</span>
<span class="text-xs text-primary"><span x-text="telemetry.gnosis_integrity + '%'">98.4%</span></span>
</div>
<div class="h-2 w-full bg-[#222] rounded-full overflow-hidden">
<div class="h-full bg-primary relative overflow-hidden" :style="'width: ' + telemetry.gnosis_integrity + '%'">
<div class="absolute inset-0 bg-white/20 w-full animate-[shimmer_2s_infinite]"></div>
</div>
</div>
<div class="flex justify-between mt-1 text-[10px] text-[#555] font-mono">
<span>MIN: 85%</span>
<span>MAX: 100%</span>
</div>
</div>
<!-- Gauge 2 -->
<div>
<div class="flex justify-between mb-2">
<span class="text-xs text-[#888] font-bold">ENTROPIC FUEL</span>
<span class="text-xs text-secondary"><span x-text="telemetry.entropic_fuel + '%'">42.1%</span></span>
</div>
<div class="h-2 w-full bg-[#222] rounded-full overflow-hidden">
<div class="h-full bg-secondary shadow-[0_0_10px_rgba(220,20,60,0.5)]" :style="'width: ' + telemetry.entropic_fuel + '%'"></div>
</div>
<div class="flex justify-between mt-1 text-[10px] text-[#555] font-mono">
<span>CRITICAL: 20%</span>
<span>DRAINING...</span>
</div>
</div>
<!-- Chart Placeholder -->
<div class="p-4 border border-[#333] bg-[#151515] rounded relative overflow-hidden">
<h3 class="text-xs text-[#888] mb-3 font-bold">RESONANCE HISTORY</h3>
<!-- SVG Line Chart -->
<svg class="w-full h-24 overflow-visible" viewbox="0 0 200 100">
<lineargradient id="chartGradient" x1="0" x2="0" y1="0" y2="1">
<stop offset="0%" stop-color="#ff8c00" stop-opacity="0.4"></stop>
<stop offset="100%" stop-color="#ff8c00" stop-opacity="0"></stop>
</lineargradient>
<path d="M0,50 Q20,40 40,60 T80,50 T120,30 T160,50 T200,40" fill="url(#chartGradient)" stroke="none"></path>
<path d="M0,50 Q20,40 40,60 T80,50 T120,30 T160,50 T200,40" fill="none" stroke="#ff8c00" stroke-width="2"></path>
<!-- Active Dot -->
<circle class="animate-pulse" cx="200" cy="40" fill="#fff" r="3"></circle>
</svg>
<div class="absolute top-2 right-2 flex item"></div>
</div>
</div>
</aside>
</div>

<script>
    function dashboard() {
        return {
            nodes: [],
            telemetry: {
                target_resonance: 0,
                system_integrity: 0,
                gnosis_integrity: 0,
                entropic_fuel: 0
            },
            logs: [
                { type: 'input', text: 'init_sequence --force' },
                { type: 'output', text: 'INITIALIZING RITUAL SEQUENCE...', color: 'text-primary/80' },
                { type: 'output', text: 'LOADING 8k ASSETS [################----] 82%', color: 'text-primary/80' },
                { type: 'output', text: 'WARNING: Node_Beta_04 instability detected. Resonance mismatch.', color: 'text-secondary' },
                { type: 'output', text: 'PARSING CHIMERA SYNTAX...', color: 'text-primary/80' },
                { type: 'output', text: 'SUCCESS. Protocol V.9.0 active.', color: 'text-[#4caf50]' }
            ],

            init() {
                this.fetchNodes();
                this.fetchTelemetry();
                setInterval(() => {
                    this.fetchNodes();
                    this.fetchTelemetry();
                }, 2000);
            },

            async fetchNodes() {
                const res = await fetch('/api/nodes');
                this.nodes = await res.json();
            },

            async fetchTelemetry() {
                const res = await fetch('/api/telemetry');
                this.telemetry = await res.json();
            },

            async executeCommand(cmd) {
                if (!cmd.trim()) return;

                this.logs.push({ type: 'input', text: cmd });
                this.$nextTick(() => {
                    const terminal = this.$refs.terminal;
                    terminal.scrollTop = terminal.scrollHeight;
                });

                const res = await fetch('/api/command', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ command: cmd })
                });
                const data = await res.json();

                data.response.forEach(line => {
                    this.logs.push({ type: 'output', text: line });
                });

                this.$nextTick(() => {
                    const terminal = this.$refs.terminal;
                    terminal.scrollTop = terminal.scrollHeight;
                });
            },

            async purgeSystem() {
                const res = await fetch('/api/purge', { method: 'POST' });
                const data = await res.json();
                this.logs.push({ type: 'output', text: 'PURGE SYSTEM: ' + data.message, color: 'text-secondary' });
                 this.$nextTick(() => {
                    const terminal = this.$refs.terminal;
                    terminal.scrollTop = terminal.scrollHeight;
                });
                this.fetchNodes();
            },

            async connectNode() {
                 const res = await fetch('/api/connect', { method: 'POST' });
                 const data = await res.json();
                 this.logs.push({ type: 'output', text: data.message, color: 'text-green-500' });
                  this.$nextTick(() => {
                    const terminal = this.$refs.terminal;
                    terminal.scrollTop = terminal.scrollHeight;
                });
                 this.fetchNodes();
            }
        }
    }
</script>
</body>
</html>
